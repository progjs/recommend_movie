{% extends 'movieapp/base.html' %}
{% block contents %}
{% load static %} {% load humanize %}

<head>
    <style>
        .starR{
          /*
          background-image: url('/static/movieapp/img/star.png') no-repeat right 0;
          */
          background: url("{% static 'movieapp/img/star.png' %}");
          background-size: auto 100%;
          width: 30px;
          height: 30px;
          display: inline-block;
          text-indent: -9999px;
          cursor: pointer;
        }
        .starR.on{background-position:0 0;}
    </style>
</head>

  <main id="main">
    <div class="site-section">
      <div class="container">
        <div class="row mb-4 align-items-center">
          <div class="col-md-6" data-aos="fade-up">
            <h2>{{ movie.title }}</h2>평점 {{ movie.score }}점 ({{ movie.comment_count|intcomma }}명 참여)
          </div>
        </div>
      </div>

      <div class="site-section pb-0">
        <div class="container">
          <div class="row align-items-stretch">
            <div class="col-md-5" data-aos="fade-up">
              <img src="{% static 'movieapp/img/'%}{{movie.pk}}.jpg" alt="Image" class="img-fluid">
            </div>
            <div class="col-md-6 ml-auto" data-aos="fade-up" data-aos-delay="100">
                  <h4 class="h4 mb-3"><b>상세정보</b></h4>
                <ul class="list-unstyled list-line mb-5">
                    <li>{{ movie.release_year }}년 개봉 (누적관객 {{ movie.audience|intcomma }}명)</li>
                  <li><b>장르 </b>
                      {% for genre in movie.genres.all %}
                        {{ genre.genre }}
                      {% endfor %}
                    </li>
                    <li><b>감독</b> {{ movie.director }} | {{ movie.nation }}</li>

                    <li><b>출연 </b>
                      {% for actor in movie.actors.all %}
                        {{ actor.actor }}
                      {% endfor %}
                    </li>
                </ul>

                <div class="sticky-content">
                <p class="mb-4"><span class="text-muted"></span></p>

                <div class="mb-5">
                  <p>{{ movie.plot|linebreaksbr }}</p>
                </div>

                <p><form action="{% url 'add_wishlist' pk=movie.pk %}" method="get" >
                        {% csrf_token %}
                        <button type="submit" class="save readmore d-block w-10">이 영화 찜하기</button>
                    </form>
            <!-- <a action="{% url 'add_wishlist' pk=movie.pk %}" class="readmore">이 영화 찜하기</a></p>--></p>
              </div>
            </div>
          </div>
        </div>
      </div>

    <div class="site-section">
      <div class="container">
    <table>
        <h3>New Comment</h3>
        {% if request.session.user_id %}
            <form action="{% url 'add_comment' pk=movie.pk %}" method="post" class="post-form">
                {% csrf_token %}
                {{ commentform.as_p }}
                <button type="submit" class="save readmore d-block w-10">Send</button>
            </form>
        {% else %}
            <p><a href="{% url 'login' %}">로그인</a>을 먼저 해주세요.</p>
        {% endif %}
    </table>

{% for comment in movie.comments.all %}
    <div class="comment">
        <div class="date">
            {{comment.published_date}}
        </div>
        <strong>{{comment.user.username}}</strong>
        <p>{{comment.comment_score}}점! {{comment.comment|linebreaksbr}}</p>
    </div>
{% empty %}
    <p>No comments here yet:(</p>
{% endfor %}

<!--           별점 test-->
          <div class="starRev">
              <span class="starR on">별1</span>
              <span class="starR">별2</span>
              <span class="starR">별3</span>
              <span class="starR">별4</span>
              <span class="starR">별5</span>
            </div>
    </div>
  </div>
      <div class="site-section pb-0">
        <div class="container">
          <div class="row justify-content-center text-center mb-4">
            <div class="col-5">
              <h3 class="h3 heading">More Works</h3>
              <p>Lorem ipsum dolor sit amet consectetur adipisicing elit explicabo inventore.</p>
            </div>
          </div>
        </div>
      </div>

  </main>

  <footer class="footer" role="contentinfo">
    <div class="container">
      <div class="row">
        <div class="col-sm-6">
          <p class="mb-1">&copy; Copyright MyPortfolio. All Rights Reserved</p>
          <div class="credits">
            <!--
              All the links in the footer should remain intact.
              You can delete the links only if you purchased the pro version.
              Licensing information: https://bootstrapmade.com/license/
              Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/buy/?theme=MyPortfolio
            -->
            Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
          </div>
        </div>
        <div class="col-sm-6 social text-md-right">
          <a href="#"><span class="icofont-twitter"></span></a>
          <a href="#"><span class="icofont-facebook"></span></a>
          <a href="#"><span class="icofont-dribbble"></span></a>
          <a href="#"><span class="icofont-behance"></span></a>
        </div>
      </div>
    </div>
  </footer>

<script type="text/javascript">
    $('.starRev span').click(function(){
      $(this).parent().children('span').removeClass('on');
      $(this).addClass('on').prevAll('span').addClass('on');
      return false;
    });
</script>

{% endblock contents %}